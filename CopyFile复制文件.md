# CopyFile复制文件

这是一个重复造轮子的代码，目的在于练习linux的系统调用函数

功能：将一个文件夹下的全部内容（除文件夹），拷贝到另外一个指定文件夹内

例如：./copyfile /mnt/hgfs/file1/ /mnt/hgfs/file2/



相关linux命令行功能：（现有造好的轮子）

复制单个文件：

cp /mnt/hgfs/1.txt  /mnt/hgfs/2.txt

复制一个文件夹下全部内容到另外一个文件夹下：

cp -r /mnt/hgfs/file1/.  /mnt/hgfs/file2/

注意源文件夹后面跟着一个“.”否则是复制移动整个文件夹入第二个参数的路径



## 需求与技术实现

### 需求

这是一个代码练习项目，需求如下：

> 要求完成一个文件拷贝程序。 
> 输入参数1就是路径参数 ，程序会读取这个路径下所有文件，并把这路径下的所有文件拷贝到参数2 指定的路径中
> **每个文件都创建一个进程，拷贝这个文件再这个进程下进行。**  
> copyfile 参数1  参数2   
> 参数1是源路径  参数2是目的路径 
>
> 注：
> 参数1 和参数2 如果没有输入或者格式不正确要给予提示。
> 如果给定的源路径里面还有路径（文件夹），就跳过。
> 程序 提供帮助文档  copyfile --help 能提示 参数1和参数2 具体含义并打印出来



### 技术实现

- open,read,write——copyfile函数——复制单个文件

- opendir,readdir,stat——用于打开和读取文件夹以及判断文件夹下的内容属性
- fork——用于多进程拷贝
- strcpy，strcat——文件路径的合成

逻辑难点在于一个进程拷贝一个文件的程序写法

这里采用类似递归的写法

我们假设将一对互为父子的进程，他们上和下还有各自的父进程和子进程，则我们称这对进程中的父进程为相对父进程，称这对进程中的子进程为相对子进程

则我们在相对父进程中：新readdir进来一个文件，并执行判断和复制

在相对子进程中：进行新生成子进程



例如在第一个父进程进行第一个文件的复制，在子进程中进行进程生成

则在子进程中本进程中再进行复制，孙进程中进行进程生成……

以此类推递归……子子孙孙无穷尽也

即实现需求



### 代码主体已经上传，工程需要在linux内执行，自行创建即可



